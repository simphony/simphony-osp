image: "registry.gitlab.cc-asp.fraunhofer.de:4567/simphony/osp-core:latest"

stages:
  - code_analysis
  - test

pep8:
  stage: code_analysis
  script:
    - flake8 . --exclude=*/__init__.py --ignore=W503

radon:
  stage: code_analysis
  script:
    - radon cc -s -a .
    - radon mi -s .

bandit:
  stage: code_analysis
  script:
    - bandit --version
    - bandit -r osp --skip B101

# loc:
#   stage: code_analysis
#   script:
#     - pygount osp --suffix py
#     - echo "Total lines of code:"
#     - pygount osp --suffix py | awk '{s+=$1} END {print s}'

unittesting:
  stage: test
  script:
    - tox
